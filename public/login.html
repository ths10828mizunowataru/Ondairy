  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Ondairy</title>


      <script type="module" defer>
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyCYo7gqY3tezdXmfVbkypRd2eVZXPudPGc",
          authDomain: "ih12b213-4.firebaseapp.com",
          databaseURL: "https://ih12b213-4-default-rtdb.firebaseio.com",
          projectId: "ih12b213-4",
          storageBucket: "ih12b213-4.appspot.com",
          messagingSenderId: "988142203119",
          appId: "1:988142203119:web:eea1669d6d6401350e2b1a",
          measurementId: "G-C80M7XW650"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const provider = new GoogleAuthProvider();

        //ボタンを押すとログインする
        document.getElementById("login").addEventListener("click", () => {
            const email = document.getElementById("email").value
            const password = document.getElementById("pass").value
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Signed in
                    const user = userCredential.user
                    console.log(user);
                })
                .catch((error) => {
                    const errorCode = error.code
                    const errorMessage = error.message
                })

        })

          document
            .getElementById("google")
            .addEventListener("click", () => {
                signInWithPopup(auth, provider)
                    .then((result) => {
                        // This gives you a Google Access Token. You can use it to access the Google API.
                        const credential = GoogleAuthProvider.credentialFromResult(result);
                        const token = credential.accessToken;
                        // The signed-in user info.
                        const user = result.user
                        console.log(user)

                    }).catch((error) => {
                        // Handle Errors here.
                        const errorCode = error.code;
                        const errorMessage = error.message;
                        // The email of the user's account used.
                        const email = error.customData.email;
                        // The AuthCredential type that was used.
                        const credential = GoogleAuthProvider.credentialFromError(error);
                    })
            })


          onAuthStateChanged(auth, (user) => {
              if (user) {
                  // 認証状態だったら
                location.href = "./index.html"
              } else {
              }
          });

          document.getElementById("signout").addEventListener("click", () => {
                signOut(auth).then(() => {
                    console.log("successful");
                    location.href = "./signin.html"
                }).catch((error) => {
                    console.log(error);
                })
            })


        //データ更新
        /*
        document.getElementById("re-submit").addEventListener("click", () => {
          var db = firebase.firestore();

          db.collection("顧客のドキュメント名を指定").doc().update({
                title: "メールアドレス,パスワードリセット",
                email: document.getElementById("email").value,
                pass: document.getElementById("pass").value
            })
            .then(() => {
                console.log("Document successfully written!");
            })
            .catch((error) => {
                console.error("Error writing document: ", error);
            });
        })
        */

        /*
        Authenticationのサンプル
        https://www.topgate.co.jp/firebase05-firebase-authentication
        https://blog.katsubemakito.net/firebase/firebase-authentication-email-web1
        */
        //ログイン認証
        // document.getElementById("submit").addEventListener("click", member_submit);

        // const member_submit = function () {
        //   const $email = document.getElementById("email");
        //   const $password = document.getElementById("password");
        //   const email = $email.value;
        //   const password = $password.value;
        //   createUserWithEmailAndPassword(getAuth(), email, password)
        //     .then((userCredential) => {
        //       console.log("登録完了");
        //     })
        //     .catch((error) => {
        //       console.log(error.code);
        //     });
        // }

        //ログイン状況表示
        // document.getElementById("login-view").addEventListener("click", registerUser);

        // const registerUser = function () {
        //     //Authオブジェクトを取得
        //   const auth2 = getAuth();
        //   const email = document.getElementById("email").value;
        //   const password = document.getElementById("password").value;

        //   createUserWithEmailAndPassword(auth, email, password)
        //     //サインイン成功時の処理
        //     .then(function (userCredential) {

        //       //updateProfileメソッドでdisplayNameに情報を登録
        //       updateProfile(auth2.currentUser, {
        //         displayName: auth2.currentUser.email.split('@')[0],
        //       })
        //         .then(function () {
        //           console.log(displayName);
        //         }).catch(function () {
        //           //ユーザー情報をアップデートできなかった時の処理
        //         });

        //     }).catch(() => {
        //     //サインインできなかった時の処理
        //     });
        // }

      </script>
    </head>
    <body>
      <a href="index.html"><button>トップ画面</button></a>
      <a href="login.html"><button>ログイン</button></a>
      <a href="editor.html"><button>編集画面</button></a>
      <a href="cart.html"><button>カート画面</button></a>
      <div>

      <button class="p-4 bg-stone-300 rounded" id="signout">サインアウト</button>
      </div>

      <!--FireStoreのサンプル
      https://blog.katsubemakito.net/firebase/firebase-authentication-email-web1
      -->

      <div>
        <label for="email">メールアドレス</label>
        <input type="email" id="email" name="email">
        <label for="pass">パスワード</label>
        <input type="password" id="pass" name="pass" autocomplete="on">
        <button id="login">ログイン</button>
        <button id="submit">新規登録</button>
      </div>
      <button id="google">Googleでサインインする</button>

      <script>
        //入力内容をfirestoreに渡す
        // document.getElementById("login").addEventListener("click", () => {
        //     const email = document.getElementById("email").value
        //     const password = document.getElementById("pass").value
        //     signInWithEmailAndPassword(auth, email, password)
        //         .then((userCredential) => {
        //             // Signed in
        //             const user = userCredential.user
        //             console.log(user);
        //         })
        //         .catch((error) => {
        //             const errorCode = error.code
        //             const errorMessage = error.message
        //         })

        // })
      </script>
    </body>
  </html>