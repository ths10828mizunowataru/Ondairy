
/* --------------------------------------------------------------------------------
5-1-3 ドロップダウンメニュー（写真付 上ナビ）
-------------------------------------------------------------------------------- */
    
//ドロップダウンの設定を関数でまとめる
function mediaQueriesWin(){
	var width = $(window).width();
	if(width <= 920) {//横幅が920px以下の場合
		$(".has-child>a").off('click');	//has-childクラスがついたaタグのonイベントを複数登録を避ける為offにして一旦初期状態へ
		$(".has-child>a").on('click', function() {//has-childクラスがついたaタグをクリックしたら
			var parentElem =  $(this).parent();// aタグから見た親要素の<li>を取得し
			$(parentElem).toggleClass('active');//矢印方向を変えるためのクラス名を付与して
			$(parentElem).children('ul').stop().slideToggle(500);//liの子要素のスライドを開閉させる※数字が大きくなるほどゆっくり開く
			return false;//リンクの無効化
		});
	}else{//横幅が920px以上の場合
		$(".has-child>a").off('click');//has-childクラスがついたaタグのonイベントをoff(無効)にし
		$(".has-child>a").removeClass('active');//activeクラスを削除
		$('.has-child').children('ul').css("display","");//スライドトグルで動作したdisplayも無効化にする
	}
}



/*===========================================================*/
/*8-1-8リンクボタンをクリックしたら形状が変化*/
/*===========================================================*/

//スクロールした際の動きを関数でまとめる
function PageTopAnime() {
	var scroll = $(window).scrollTop();
	if (scroll >= 100){//上から100pxスクロールしたら
		$('#page-top').removeClass('DownMove');//#page-topについているDownMoveというクラス名を除く
		$('#page-top').addClass('UpMove');//#page-topについているUpMoveというクラス名を付与
	}else{
		if($('#page-top').hasClass('UpMove')){//すでに#page-topにUpMoveというクラス名がついていたら
			$('#page-top').removeClass('UpMove');//UpMoveというクラス名を除き
			$('#page-top').addClass('DownMove');//DownMoveというクラス名を#page-topに付与
		}
	}
}


// #page-topをクリックした際の設定
$('#page-top').click(function () {
	var scroll = $(window).scrollTop(); //スクロール値を取得
	if(scroll > 0){
		$(this).addClass('floatAnime');//クリックしたらfloatAnimeというクラス名が付与
        $('body,html').animate({
            scrollTop: 0
        }, 800,function(){//スクロールの速さ。数字が大きくなるほど遅くなる
            $('#page-top').removeClass('floatAnime');//上までスクロールしたらfloatAnimeというクラス名を除く
        });	
	}
    return false;//リンク自体の無効化
});


/*===========================================================*/
/*スクロールに連動した動き*/
/*===========================================================*/

function fadeAnime(){
    
    //ふわっ
    $('.fadeInTrigger').each(function(){ //fadeInTriggerというクラス名が
		var elemPos = $(this).offset().top-50;//要素より、50px上の
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();
		if (scroll >= elemPos - windowHeight){
		$(this).addClass('fadeIn');// 画面内に入ったらfadeInというクラス名を追記
		}else{
		$(this).removeClass('fadeIn');// 画面外に出たらfadeInというクラス名を外す
		}
		});

	$('.fadeUpTrigger').each(function(){ //fadeUpTriggerというクラス名が
		var elemPos = $(this).offset().top-50;//要素より、50px上の
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();
		if (scroll >= elemPos - windowHeight){
		$(this).addClass('fadeUp');// 画面内に入ったらfadeUpというクラス名を追記
		}else{
		$(this).removeClass('fadeUp');// 画面外に出たらfadeUpというクラス名を外す
		}
		});

	$('.fadeDownTrigger').each(function(){ //fadeDownTriggerというクラス名が
		var elemPos = $(this).offset().top-50;//要素より、50px上の
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();
		if (scroll >= elemPos - windowHeight){
		$(this).addClass('fadeDown');// 画面内に入ったらfadeDownというクラス名を追記
		}else{
		$(this).removeClass('fadeDown');// 画面外に出たらfadeDownというクラス名を外す
		}
		});

	// ぱたっ

	$('.flipLeftTopTrigger').each(function(){ //flipLeftTopTriggerというクラス名が
		var elemPos = $(this).offset().top-50;//要素より、50px上の
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();
		if (scroll >= elemPos - windowHeight){
		$(this).addClass('flipLeftTop');// 画面内に入ったらflipLeftTopというクラス名を追記
		}else{
		$(this).removeClass('flipLeftTop');// 画面外に出たらflipLeftTopというクラス名を外す
		}
		});
    
	
	// ぶわっ、ぽんっ

	$('.zoomInTrigger').each(function(){ //zoomInTriggerというクラス名が
		var elemPos = $(this).offset().top-50;//要素より、50px上の
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();
		if (scroll >= elemPos - windowHeight){
		$(this).addClass('zoomIn');// 画面内に入ったらzoomInというクラス名を追記
		}else{
		$(this).removeClass('zoomIn');// 画面外に出たらzoomInというクラス名を外す
		}
		});	
    
    //txt-leftanime
$('.leftAnime').each(function(){ 
			var elemPos = $(this).offset().top-50;
			var scroll = $(window).scrollTop();
			var windowHeight = $(window).height();
			if (scroll >= elemPos - windowHeight){
				$(this).addClass("slideAnimeLeftRight");
				$(this).children(".leftAnimeInner").addClass("slideAnimeRightLeft");
			}else{
				$(this).removeClass("slideAnimeLeftRight");
				$(this).children(".leftAnimeInner").removeClass("slideAnimeRightLeft");
				
			}
		});

    //topself
    $('.selfTrigger').each(function(){
		var elemPos = $(this).offset().top-50;//要素より、50px上の
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();
		if (scroll >= elemPos - windowHeight){
		$(this).addClass('self');
		}else{
		$(this).removeClass('self');
		}
		});


	
}

/*===========================================================*/
/*TEXT*/
/*===========================================================*/

// rollAnimeにrollというクラス名を付ける定義
function RollAnimeControl() {
	$('.rollAnime').each(function () {
		var elemPos = $(this).offset().top - 50;
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();
		var childs = $(this).children();	//rollAnimeの子要素を取得
		if (scroll >= elemPos - windowHeight) {
			$(childs).each(function (i) {		//子要素を1つ1つ処理をおこなう
				if (i < 10) {					//10未満の場合
				$(this).css("transition-delay","."+i+"s");	//子要素にcsstransition-delayを追加
				}else {							//10以上の場合
					var n = i / 10;				//ミリ秒指定なので10で割る
					$(this).css("transition-delay",n+"s");	//子要素にcsstransition-delayを追加
				}
			});
			
			$(this).addClass("roll"); //rollというアニメーションクラスを付与

		} else {
			$(childs).each(function () {		//子要素を1つ1つ処理をおこなう
				$(this).css("transition-delay","0s");//子要素にcsstransition-delayの秒を0とする
			});
			$(this).removeClass("roll");//rollというアニメーションクラスを除去
		}
	});
}


/*===========================================================*/
/*PNGアニメーション（APNG）*/
/*===========================================================*/

APNG.ifNeeded().then(function () {
	var images = document.querySelectorAll(".apng-image");
	for (var i = 0; i < images.length; i++) APNG.animateImage(images[i]);
});

/*===========================================================*/
/*関数をまとめる*/
/*===========================================================*/


// ページがリサイズされたら動かしたい場合の記述
$(window).resize(function() {
	mediaQueriesWin();/* ドロップダウンの関数を呼ぶ*/
});

// ページがスクロールされたら動かしたい場合の記述
$(window).scroll(function () {
    fadeAnime();//スクロールに連動した動きの関数を呼ぶ
    PageTopAnime();//8-1-8	リンクボタンをクリックしたら形状が変化の関数を呼ぶ
});


// ページが読み込まれたらすぐに動かしたい場合の記述
$(window).on('load',function(){	
    $("#splash-logo").delay(500).fadeOut('slow');//ロゴを0.5秒でフェードアウトする記述
    PageTopAnime();// 8-1-8	リンクボタンをクリックしたら形状が変化の関数を呼ぶの関数を呼ぶ
    mediaQueriesWin();/* ドロップダウンの関数を呼ぶ*/
    fadeAnime();//スクロールに連動した動きの関数を呼ぶ

    //spanタグを追加する
	var element = $(".rollAnime");
	element.each(function () {
		var text = $(this).text();
		var textbox = [];
		text.split('').forEach(function (t, i) {
			if (t !== " ") {
				if (i < 10) {
					textbox += '<span style="transition-delay:.' + i + 's;">' + t + '</span>';
				} else {
					var n = i / 10;
					textbox += '<span style="transition-delay:' + n + 's;">' + t + '</span>';
				}

			} else {
				textbox += t;
			}
		});
		$(this).html(textbox);
	});

	RollAnimeControl();/* アニメーション用の関数を呼ぶ*/

        
		$('body').addClass('appear');//フェードアウト後bodyにappearクラス付与
		
        var h = $(window).height();//ブラウザの高さを取得
		$(".splashbg").css({
			"border-width":h,//ボーダーの太さにブラウザの高さを代入
			"animation-name":"backBoxAnime"//animation-nameを定義
		});	

    
});// ここまでページが読み込まれたらすぐに動かしたい場合の記述
